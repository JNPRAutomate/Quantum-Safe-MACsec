
# **Table of contents**

<!-- TOC -->
- [Document Control](#document-control)
  - [Document Information](#document-information)
  - [Document History](#document-history)
  - [Document Approvals](#document-approvals)
- [**Table of contents**](#table-of-contents)
  - [1. Introduction](#1-introduction)
    - [1.1 MACsec overview](#11-macsec-overview)
    - [1.2 PQC and MACsec integration](#12-pqc-and-macsec-integration)
    - [1.3 Terminology and Entities involved](#13-terminology-and-entities-involved)
    - [1.4 Static CAK](#14-static-cak)
- [2. The core python MACsec/QKD script](#2-the-core-python-macsecqkd-script)
  - [2.1 Release Notes for MACSEC Configuration Script](#21-release-notes-for-macsec-configuration-script)
    - [2.1.1 Version 3.0.0](#211-version-300)
    - [2.1.2 Overview](#212-overview)
      - [2.1.2.1 New Features](#2121-new-features)
      - [2.1.2.2 Features and Enhancements](#2122-features-and-enhancements)
      - [2.1.2.3 Configuration](#2123-configuration)
      - [2.1.2.4 Usage](#2124-usage)
      - [Configuration](#configuration)
      - [2.1.2.5 Error Handling](#2125-error-handling)
      - [2.1.2.6 Known/Potential Issues/Limitations](#2126-knownpotential-issueslimitations)
      - [Future Improvements](#future-improvements)
      - [2.1.2.7 Contribution](#2127-contribution)
      - [2.1.2.8 License](#2128-license)
  - [2.2 Script details](#22-script-details)
    - [2.2.1 Entities involved in the communication](#221-entities-involved-in-the-communication)
    - [2.2.2 REST APIs used in key exchange](#222-rest-apis-used-in-key-exchange)
    - [2.2.3 QKD-MACsec key exchange automation](#223-qkd-macsec-key-exchange-automation)
      - [2.2.3.1 Key exchange mechanism between 2 Juniper devices](#2231-key-exchange-mechanism-between-2-juniper-devices)
    - [2.2.4 Script main functions](#224-script-main-functions)
      - [2.2.4.1 Main KME/SAE interaction](#2241-main-kmesae-interaction)
      - [2.2.4.2 Detailed View](#2242-detailed-view)
      - [2.2.4.3 Function Purpose](#2243-function-purpose)
      - [2.2.4.4 Parameters](#2244-parameters)
      - [2.2.4.5 Function Steps](#2245-function-steps)
    - [2.2.5 Multi threading function](#225-multi-threading-function)
    - [2.2.6 Certificate life cycle management (LCM)](#226-certificate-life-cycle-management-lcm)
      - [2.2.6.1 Generate client certificate function](#2261-generate-client-certificate-function)
      - [2.2.6.2 Is certificate valid function](#2262-is-certificate-valid-function)
      - [2.2.6.3 Create SSH client function](#2263-create-ssh-client-function)
      - [2.2.6.4 Get certificates function](#2264-get-certificates-function)
      - [2.2.6.5 Upload certificates function](#2265-upload-certificates-function)
      - [2.2.6.6 Fetch CA certificate function](#2266-fetch-ca-certificate-function)
      - [2.2.6.7 Renew certificates function](#2267-renew-certificates-function)
      - [2.2.6.8 Should check certs function](#2268-should-check-certs-function)
    - [2.2.7 Logging and tracing](#227-logging-and-tracing)
      - [2.2.7.1 Initialize logging function](#2271-initialize-logging-function)
      - [2.2.7.2 Get Args function](#2272-get-args-function)
    - [2.2.8 Initial configuration](#228-initial-configuration)
      - [2.2.8.1 Check and apply initial config function](#2281-check-and-apply-initial-config-function)
        - [2.2.8.1.1 Function Purpose](#22811-function-purpose)
        - [2.2.8.1.2 Parameters](#22812-parameters)
        - [2.2.8.1.3 Function Steps](#22813-function-steps)
    - [2.2.9 Configurations](#229-configurations)
      - [2.2.9.1 Macsec configuration function](#2291-macsec-configuration-function)
      - [2.2.9.2 Event-options](#2292-event-options)
      - [2.2.9.3 Other necessary config](#2293-other-necessary-config)
      - [2.2.9.4 Description of the macros](#2294-description-of-the-macros)
    - [2.2.10 Key Management functions](#2210-key-management-functions)
      - [2.2.10.1 Fetch KME key function](#22101-fetch-kme-key-function)
      - [2.2.10.2 Get previous key ids function](#22102-get-previous-key-ids-function)
      - [2.2.10.3 Save key ids function](#22103-save-key-ids-function)
- [3. Appendix](#3-appendix)
  - [3.1 Glossary of MACsec Concepts](#31-glossary-of-macsec-concepts)
    - [3.1.1 AN - Association Number](#311-an---association-number)
    - [3.1.2 CA - Connectivity Association](#312-ca---connectivity-association)
    - [3.1.3 CAK - Connectivity Association Key](#313-cak---connectivity-association-key)
    - [3.1.4 CKN - Connectivity Association Key Name](#314-ckn---connectivity-association-key-name)
    - [3.1.5 ICV - Integrity Check Value](#315-icv---integrity-check-value)
    - [3.1.6 MKA - MACsec Key Agreement](#316-mka---macsec-key-agreement)
    - [3.1.7 SA - Secure Association](#317-sa---secure-association)
    - [3.1.8 SAK - Secure Association Key](#318-sak---secure-association-key)
    - [3.1.9 SC - Secure Channel](#319-sc---secure-channel)
    - [3.1.10 SCI - Secure Channel Identifier](#3110-sci---secure-channel-identifier)
    - [3.1.11 SecTAG - MAC Security Tag](#3111-sectag---mac-security-tag)
    - [3.1.12 XPN - Packet Number and eXtended Packet Number](#3112-xpn---packet-number-and-extended-packet-number)
  - [3.2 Imported Packages and Modules Synthesis](#32-imported-packages-and-modules-synthesis)
    - [3.2.1 `requests`](#321-requests)
    - [3.2.2 `jnpr.junos (Device, Config)`](#322-jnprjunos-device-config)
    - [3.2.3 `paramiko (SSHException)`](#323-paramiko-sshexception)
    - [3.2.4 `scp (SCPClient, SCPException)`](#324-scp-scpclient-scpexception)
    - [3.2.5 `lxml (etree, E)`](#325-lxml-etree-e)
    - [3.2.6 `argparse`](#326-argparse)
    - [3.2.7 `threading (Thread, Lock)`](#327-threading-thread-lock)
    - [3.2.8 `logging (handlers)`](#328-logging-handlers)
    - [3.2.9 `json`](#329-json)
    - [3.2.10 `copy`](#3210-copy)
    - [3.2.11 `base64`](#3211-base64)
    - [3.2.12 `uuid`](#3212-uuid)
    - [3.2.13 `re`](#3213-re)
    - [3.2.14 `subprocess`](#3214-subprocess)
    - [3.2.15 `os`](#3215-os)
    - [3.2.16 `OpenSSL (crypto)`](#3216-openssl-crypto)
    - [3.2.17 `datetime`](#3217-datetime)
    - [3.2.18 `schedule`](#3218-schedule)
    - [3.2.19 `Profile`](#3219-profile)
    - [3.2.20 `time`](#3220-time)
  - [3.3 Logs](#33-logs)
    - [3.3.1 Sample logs](#331-sample-logs)
        - [3.3.1.1 Offbox parallel execution (4 devices under test: mx304-11, mx304-12, mx10008-23 and mx10008-24)](#3311-offbox-parallel-execution-4-devices-under-test-mx304-11-mx304-12-mx10008-23-and-mx10008-24)
        - [3.3.1.2 Onbox execution (master device under test: mx304-11)](#3312-onbox-execution-master-device-under-test-mx304-11)
        - [3.3.1.3 Onbox execution (slave device under test: mx304-12)](#3313-onbox-execution-slave-device-under-test-mx304-12)
        - [3.3.1.4 Onbox execution (additional slave device under test: mx10008-23)](#3314-onbox-execution-additional-slave-device-under-test-mx10008-23)
        - [3.3.1.5 Onbox execution (additional slave device under test: mx10008-24)](#3315-onbox-execution-additional-slave-device-under-test-mx10008-24)
- [License](#license)
- [Acknowledgements](#acknowledgements)

<!-- TOC-->
